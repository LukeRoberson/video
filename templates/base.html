<!--
    base.html

    Base template for the video web application.
    Provides the main HTML structure, navigation bar, and includes Bootstrap and custom styles.
    Child templates should extend this file and override the 'title', 'head', and 'content' blocks as needed.
-->

<!DOCTYPE html>
<html>
    <!-- Head block -->
    <head>
        <meta charset="utf-8" />

        <!-- Title is set by the child template -->
        <title>{% block title %}{% endblock %}</title>
        
        <!-- favicon -->
        <link rel="icon" type="image/png" sizes="32x32" href="{{ url_for('static', filename='icons/favicon-32x32.png') }}">
        <link rel="icon" type="image/png" sizes="16x16" href="{{ url_for('static', filename='icons/favicon-16x16.png') }}">
        <link rel="apple-touch-icon" sizes="180x180" href="{{ url_for('static', filename='icons/apple-touch-icon.png') }}">
        <link rel="manifest" href="{{ url_for('static', filename='icons/site.webmanifest') }}">        <!-- CSS files: Local CSS files come last to override 3rd party ones -->

        <!-- Bootstrap CSS -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/styles.css')}}" />
        
        <!-- Child templates add <head> tags here -->
        {% block head %}
        {% endblock %}
    </head>
    <script src="{{ url_for('static', filename='js/scroll.js') }}"></script>

    <!-- Body Block -->
    <body>
        <!-- Navigation bar -->
        <div class="navbar navbar-expand-lg navbar-dark bg-dark">
            <div class="container-fluid d-flex justify-content-between align-items-center">
                <!-- Links to other pages: Aligned left -->
                <div class="d-flex align-items-center">
                    <!-- Home Link -->
                    <a href="{{ url_for('home') }}" class="navbar-brand">Home</a>
                    
                    <!-- Admin Page -->
                    <a href="{{ url_for('admin_dashboard') }}" class="navbar-brand">Admin</a>

                    <!-- Dropdown for categoies -->
                    <div class="dropdown ms-3">
                        <a class="btn btn-secondary dropdown-toggle navbar-item" href="#" role="button" id="categoriesDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                            Categories
                        </a>
                        <ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="categoriesDropdown">
                            <li><a class="dropdown-item" href="{{ url_for('category_pages.broadcasting') }}">Broadcasting</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('category_pages.children') }}">Children</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('category_pages.teens') }}">Teenagers</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('category_pages.family') }}">Family</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('category_pages.programs_events') }}">Programs and Events</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('category_pages.our_activities') }}">Our Activities</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('category_pages.meetings_ministry') }}">Our Meetings and Ministry</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('category_pages.organization') }}">Our Organization</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('category_pages.bible') }}">The Bible</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('category_pages.dramas') }}">Dramas</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('category_pages.series') }}">Series</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('category_pages.music') }}">Music</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('category_pages.interviews') }}">Interviews and Experiences</a></li>
                        </ul>
                    </div>
                </div>
                
                <!-- Profile icon: Aligned right -->
                <div class="d-flex align-items-center">
                    <span id="profile-name" class="me-2 text-white">Guest</span>
                    <a href="{{ url_for('select_profile') }}" class="bg-secondary rounded-circle d-flex justify-content-center align-items-center text-decoration-none" style="width:32px; height:32px;">
                        <img id="profile-img" src="/static/img/profiles/guest.png" alt="Profile" class="rounded-circle" style="width:28px; height:28px; object-fit:cover;">
                    </a>
                </div>
            </div>
        </div>
        <div class="body-content">
            {% block content %}
            {% endblock %}
        </div>

        <!-- Bootstrap JS (with Popper) -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
        <script>
            fetch('/api/profile/get_active')
            .then(res => res.json())
            .then(profile => {
                console.log('Active profile:', profile.active_profile.name);
                document.getElementById('profile-name').textContent = profile.active_profile.name || 'Guest';
                document.getElementById('profile-img').src = '/static/img/profiles/' + (profile.active_profile.image || 'guest.png');
                document.getElementById('profile-img').alt = profile.active_profile.name || 'Guest';
            });
        </script>
    </body>
</html>
